{"class_name": "Functional", "config": {"name": "affine_model", "layers": [{"class_name": "InputLayer", "config": {"batch_input_shape": [null, 128, 128, 128, 1], "dtype": "float32", "sparse": false, "ragged": false, "name": "movable_input"}, "name": "movable_input", "inbound_nodes": []}, {"class_name": "InputLayer", "config": {"batch_input_shape": [null, 128, 128, 128, 1], "dtype": "float32", "sparse": false, "ragged": false, "name": "fixed_input"}, "name": "fixed_input", "inbound_nodes": []}, {"class_name": "Concatenate", "config": {"name": "input_pair", "trainable": true, "dtype": "float32", "axis": -1}, "name": "input_pair", "inbound_nodes": [[["fixed_input", 0, 0, {}], ["movable_input", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "conv1", "trainable": true, "dtype": "float32", "filters": 16, "kernel_size": [3, 3, 3], "strides": [2, 2, 2], "padding": "same", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": {"class_name": "LeakyReLU", "config": {"name": "leaky_re_lu", "trainable": true, "dtype": "float32", "alpha": 0.009999999776482582}}, "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "conv1", "inbound_nodes": [[["input_pair", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "conv2", "trainable": true, "dtype": "float32", "filters": 32, "kernel_size": [3, 3, 3], "strides": [2, 2, 2], "padding": "same", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": {"class_name": "LeakyReLU", "config": {"name": "leaky_re_lu_1", "trainable": true, "dtype": "float32", "alpha": 0.009999999776482582}}, "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "conv2", "inbound_nodes": [[["conv1", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "conv3", "trainable": true, "dtype": "float32", "filters": 64, "kernel_size": [3, 3, 3], "strides": [2, 2, 2], "padding": "same", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": {"class_name": "LeakyReLU", "config": {"name": "leaky_re_lu_2", "trainable": true, "dtype": "float32", "alpha": 0.009999999776482582}}, "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "conv3", "inbound_nodes": [[["conv2", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "conv3_1", "trainable": true, "dtype": "float32", "filters": 64, "kernel_size": [3, 3, 3], "strides": [1, 1, 1], "padding": "same", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": {"class_name": "LeakyReLU", "config": {"name": "leaky_re_lu_3", "trainable": true, "dtype": "float32", "alpha": 0.009999999776482582}}, "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "conv3_1", "inbound_nodes": [[["conv3", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "conv4", "trainable": true, "dtype": "float32", "filters": 128, "kernel_size": [3, 3, 3], "strides": [2, 2, 2], "padding": "same", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": {"class_name": "LeakyReLU", "config": {"name": "leaky_re_lu_4", "trainable": true, "dtype": "float32", "alpha": 0.009999999776482582}}, "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "conv4", "inbound_nodes": [[["conv3_1", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "conv4_1", "trainable": true, "dtype": "float32", "filters": 128, "kernel_size": [3, 3, 3], "strides": [1, 1, 1], "padding": "same", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": {"class_name": "LeakyReLU", "config": {"name": "leaky_re_lu_5", "trainable": true, "dtype": "float32", "alpha": 0.009999999776482582}}, "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "conv4_1", "inbound_nodes": [[["conv4", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "conv5", "trainable": true, "dtype": "float32", "filters": 256, "kernel_size": [3, 3, 3], "strides": [2, 2, 2], "padding": "same", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": {"class_name": "LeakyReLU", "config": {"name": "leaky_re_lu_6", "trainable": true, "dtype": "float32", "alpha": 0.009999999776482582}}, "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "conv5", "inbound_nodes": [[["conv4_1", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "conv5_1", "trainable": true, "dtype": "float32", "filters": 256, "kernel_size": [3, 3, 3], "strides": [1, 1, 1], "padding": "same", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": {"class_name": "LeakyReLU", "config": {"name": "leaky_re_lu_7", "trainable": true, "dtype": "float32", "alpha": 0.009999999776482582}}, "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "conv5_1", "inbound_nodes": [[["conv5", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "conv6", "trainable": true, "dtype": "float32", "filters": 512, "kernel_size": [3, 3, 3], "strides": [2, 2, 2], "padding": "same", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": {"class_name": "LeakyReLU", "config": {"name": "leaky_re_lu_8", "trainable": true, "dtype": "float32", "alpha": 0.009999999776482582}}, "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "conv6", "inbound_nodes": [[["conv5_1", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "conv6_1", "trainable": true, "dtype": "float32", "filters": 512, "kernel_size": [3, 3, 3], "strides": [1, 1, 1], "padding": "same", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": {"class_name": "LeakyReLU", "config": {"name": "leaky_re_lu_9", "trainable": true, "dtype": "float32", "alpha": 0.009999999776482582}}, "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "conv6_1", "inbound_nodes": [[["conv6", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "rot_matrix", "trainable": true, "dtype": "float32", "filters": 9, "kernel_size": [2, 2, 2], "strides": [1, 1, 1], "padding": "valid", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "rot_matrix", "inbound_nodes": [[["conv6_1", 0, 0, {}]]]}, {"class_name": "Conv3D", "config": {"name": "trans_matrix", "trainable": true, "dtype": "float32", "filters": 3, "kernel_size": [2, 2, 2], "strides": [1, 1, 1], "padding": "valid", "data_format": "channels_last", "dilation_rate": [1, 1, 1], "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "trans_matrix", "inbound_nodes": [[["conv6_1", 0, 0, {}]]]}, {"class_name": "Lambda", "config": {"name": "affine_matrix", "trainable": true, "dtype": "float32", "function": ["4wEAAAAAAAAAAAAAAAwAAAAGAAAAQwAAAHNEAQAAfAAvAn0BfQJnAGQBogEvA30DfQR9BXQAoAF8\nAWcAZAKiAaECfQF0AKACfANkAxgACwBkBBsAfANkBBsAZAV0AGoDoQR9BnQAoAF8BmcAZAaiAaEC\nfQZ0AKACfARkAxgACwBkBBsAfARkBBsAZAV0AGoDoQR9B3QAoAF8B2cAZAeiAaECfQd0AKACfAVk\nAxgACwBkBBsAfAVkBBsAZAV0AGoDoQR9CHQAoAF8CGcAZAiiAaECfQh8AWQJZAmFAmQJZAmFAmQK\nZgMZAH0JdACgAXwJZwBkC6IBoQJ9CXwBZAlkCYUCZAlkCYUCZANmAxkAfQp0AKABfApnAGQLogGh\nAn0KfAFkCWQJhQJkCWQJhQJkDGYDGQB9C3QAoAF8C2cAZAuiAaECfQt8BnwJFAB8B3wKFAAXAHwI\nfAsUAHwCFwAXAFMAKQ36iwogICAgRnVuY3Rpb24gdG8gdHJhbnNmb3JtIHRoZSBXIHJvdGF0aW9u\nIHBhcmFtZXRlcnMgYW5kIGIgZGlzcGxhY2VtZW50CiAgICBwYXJhbWV0ZXJzIGluIGFuIGFmZmlu\nZSBmbG93IHRvIGFwcGx5IHRvIHRoZSBtb3ZhYmxlIGltYWdlCiAgICApA+cAAAAAAABgQHICAAAA\ncgIAAACpA+n/////6QMAAAByBQAAAOkBAAAAZwAAAAAAAABA5wAAAAAAAPA/KQVyBgAAAHIEAAAA\ncgYAAAByBgAAAHIGAAAAKQVyBgAAAHIGAAAAcgQAAAByBgAAAHIGAAAAKQVyBgAAAHIGAAAAcgYA\nAAByBAAAAHIGAAAATukAAAAAKQVyBAAAAHIGAAAAcgYAAAByBgAAAHIFAAAA6QIAAAApBNoCdGba\nB3Jlc2hhcGXaBXJhbmdl2gdmbG9hdDMyKQzaBmlucHV0c9oBV9oBYtoEbGVuMdoEbGVuMtoEbGVu\nM9oCeHLaAnly2gJ6ctoCd3jaAnd52gJ3eqkAchoAAAD6jEM6L1VzZXJzL05ldXJvSW0vRG9jdW1l\nbnRzL09uZURyaXZlIC0gVW5pdmVyc2l0YScgZGVnbGkgU3R1ZGkgZGVsbGEgQ2FtcGFuaWEgTHVp\nZ2kgVmFudml0ZWxsaS9jb2RlL2FpX21vdGlvbl9jb3JyZWN0aW9uL3V0aWxzX2RjbV8yaW5wdXRz\nLnB52gthZmZpbmVfZmxvd1YAAABzIAAAAAAGCAMOAxAEIAEQASABEAEgARABFgEQARYBEAEWARAC\n", null, null], "function_type": "lambda", "module": "utils_dcm_2inputs", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "affine_matrix", "inbound_nodes": [[["rot_matrix", 0, 0, {}], ["trans_matrix", 0, 0, {}]]]}, {"class_name": "Dense3DSpatialTransformer", "config": {"padding": false}, "name": "dense3d_spatial_transformer", "inbound_nodes": [[["movable_input", 0, 0, {}], ["affine_matrix", 0, 0, {}]]]}], "input_layers": [["fixed_input", 0, 0], ["movable_input", 0, 0]], "output_layers": [["dense3d_spatial_transformer", 0, 0], ["rot_matrix", 0, 0], ["trans_matrix", 0, 0]]}, "keras_version": "2.6.0", "backend": "tensorflow"}